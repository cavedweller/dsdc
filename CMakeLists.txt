cmake_minimum_required (VERSION 2.8.11)
project (OKWS)

FIND_PACKAGE(BISON REQUIRED)
FIND_PACKAGE(FLEX REQUIRED)

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=gnu++11")
set(OKWS_BINARY_DIR ${CMAKE_CURRENT_BINARY_DIR})
set(OKWS_SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR})
set(DSDC_BINARY_DIR ${CMAKE_CURRENT_BINARY_DIR})
set(DSDC_SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR})

set(GLOBAL_INCLUDES /usr/local/include/sfslite-1.2/shopt/)

set(GLOBAL_LINKS /usr/lib/ # ld.gold doesn't look here by default
                 /usr/local/lib/) # ld.gold doesn't look here by default

# in source code replacements
add_definitions(-DDSDC_VERSION_STR="\\"3.2.0\\"")
add_definitions(-DDSDC_EXEC_BINDIR="\\"/usr/local/etc/okws\\"")
add_definitions(-DOKWS_CONFIG_DIR="\\"/usr/local/etc/okws\\"")
add_definitions(-DOKWS_VERSION="\\"3.2.0\\"")
add_definitions(-DVERSION="\\"3.2.0\\"")
set(okws_version_major 3)
set(okws_version_minor 2)
set(okws_version_patchlevel 0)

# TODO don't do this
add_definitions(-DPATH_CPP="/usr/bin/cpp")

#INCLUDE(CheckSymbolExists)
#INCLUDE(CheckIncludeFiles)
#INCLUDE(CheckFunctionExists)
#include(CheckLibraryExists)
#CHECK_LIBRARY_EXISTS(mysqlclient mysql_real_connect mysql.h HAVE_MYSQL)
#CHECK_LIBRARY_EXISTS(mysqlclient mysql_stmt_bind_param mysql.h HAVE_MYSQL_BIND)
#CHECK_LIBRARY_EXISTS(mysqlclient mysql_stmt_bind_param mysql.h HAVE_MYSQL_BINDFUNCS)
#CHECK_INCLUDE_FILES (malloc.h HAVE_MALLOC_H)
#CHECK_INCLUDE_FILES (memory.h HAVE_MEMORY_H)
#CHECK_INCLUDE_FILES (sys/types.h HAVE_SYS_TYPES_H)
#CHECK_INCLUDE_FILES (sys/stat.h HAVE_SYS_TYPES_H)
#CHECK_INCLUDE_FILES (stdlib.h STDC_HEADERS)
#CHECK_INCLUDE_FILES (strings.h HAVE_STRING_H)
#CHECK_INCLUDE_FILES (inttypes.h HAVE_INTTYPES_H)
#CHECK_INCLUDE_FILES (stdint.h HAVE_STDINT_H)
#CHECK_INCLUDE_FILES (unistd.h HAVE_UNISTD_H)
#CHECK_INCLUDE_FILES (expat.h HAVE_EXPAT)
#CHECK_INCLUDE_FILES (pthread.h HAVE_PTHREADS)
#CHECK_INCLUDE_FILES ("sys/param.h;sys/mount.h" HAVE_SYS_MOUNT_H)
#CHECK_SYMBOL_EXISTS (mpz_xor gmp.h HAVE_GMP_CXX_OPS)
#CHECK_INCLUDE_FILES (openssl/ssl.h HAVE_SSL)
#CHECK_INCLUDE_FILES (/usr/include/mysql/mysql.h HAVE_MYSQL)
#CHECK_SYMBOL_EXISTS (mysql_stmt_bind_param /usr/include/mysql/mysql.h HAVE_MYSQL_BINDFUNCS)
#
#CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/okwsconf.h.in ${CMAKE_CURRENT_BINARY_DIR}/okwsconf.h)

add_subdirectory(libdsdc)
#add_subdirectory(py/dsdc)
add_subdirectory(dsdc)
#add_subdirectory(pub)
#add_subdirectory(libokxml)
#add_subdirectory(libamt_pthread)
#add_subdirectory(libamt)
#add_subdirectory(libamysql)
#add_subdirectory(okd)
#add_subdirectory(librfn)
#add_subdirectory(libaok)
#add_subdirectory(libokssl)
#add_subdirectory(libahttp)
#add_subdirectory(libpub)
#add_subdirectory(libweb)
#add_subdirectory(ezdb)
#add_subdirectory(libredis)
#add_subdirectory(ssld)
#add_subdirectory(logd)
